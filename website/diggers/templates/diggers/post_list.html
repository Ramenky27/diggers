{% extends 'diggers/layouts/blog.html' %}
{% load static %}

{% block title %}Блоґ{% endblock %}

{% block content %}
    {% if author %}
        <section>
            <h2 class="page-content__title h2">Пости користувача {{ author.username }}</h2>

            <div class="row">
                <div class="column large-3 lining">
                    {% if author.avatar %}
                        <img src="{{ author.avatar }}" alt="avatar"/>
                    {% else %}
                        <img src="{% static "images/thumb.jpg" %}" alt="avatar"/>
                    {% endif %}
                </div>
                <div class="column large-9 lining">
                    <dl>
                        <dt>Ім'я</dt>
                        <dd>
                            {% if author.first_name or author.last_namme %}
                                {{ author.first_name }} {{ author.last_name }}
                            {% else %}
                                Не вказано
                            {% endif %}
                        </dd>
                        <dt> День народження:</dt>
                        <dd>{% if author.birth_date %}{{ author.birth_date }}{% else %}Не вказано{% endif %}</dd>
                        <dt>Місцезнаходження:</dt>
                        <dd>{% if author.location %}{{ author.location }}{% else %}Не вказано{% endif %}</dd>
                        <dt>Реєстрація:</dt>
                        <dd>{{ author.date_joined }}</dd>
                        <dt>Був на сайті:</dt>
                        <dd>{% if author.last_activity %}{{ author.last_activity }}{% else %}Ніколи{% endif %}</dd>
                    </dl>
                </div>
            </div>
        </section>
    {% endif %}

    {% for post in posts %}
        <article class="entry">

            <header class="entry__header">

                <h2 class="entry__title h1">
                    <a href="{% url 'diggers:post_detail' post.pk %}" title="">{{ post.title }}</a>
                </h2>

                <div class="entry__meta">
                    <ul>
                        <li>{{ post.created_date }}</li>
                        <li>
                            <a href="{% url 'diggers:list_by_category' category=post.category.route %}" title=""
                               rel="category tag">{{ post.category.name }}</a>
                        </li>
                        <li><a href="{% url 'diggers:list_by_author' post.author %}">{{ post.author }}</a></li>
                        <li>6 Коментарів</li>
                                             {% if user.is_authenticated and post.author == user or perms.diggers.moderate_post %}
                            {% if perms.diggers.change_post %}
                                <li><a href="{% url "diggers:post_update" post.pk %}" title="">Редагувати</a></li>
                            {% endif %}

                            {% if perms.diggers.delete_cmspost %}
                                <li><a href="{% url "diggers:post_delete" post.pk %}" title="">Видалити</a></li>
                            {% endif %}
                        {% endif %}
                    </ul>
                </div>

            </header>

            <div class="entry__content">
                {{ post.text|truncatechars:400|linebreaks }}
                {% if post.text|length > 400 %}
                    <a href="{% url 'diggers:post_detail' post.pk %}">Читати далі...</a>
                {% endif %}
            </div>
        </article> <!-- end entry -->
    {% endfor %}

    {% if posts.has_other_pages %}
        <!-- page nav -->
        <div class="post-list-nav">
            <nav class="pgn">
                <ul>
                    {% if posts.has_previous %}
                        <li>
                            <a rel="prev" class="pgn__prev" href="?page={{ posts.previous_page_number }}">Попередня</a>
                        </li>
                    {% endif %}

                    {% for i in posts.paginator.page_range %}
                        <li>
                            {% if posts.number == i %}
                                <span class="pgn__num current">{{ i }}</span>
                            {% else %}
                                <a rel="page{{ i }}" class="pgn__num" href="?page={{ i }}">{{ i }}</a>
                            {% endif %}
                        </li>
                    {% endfor %}

                    {% if posts.has_next %}
                        <li>
                            <a rel="next" class="pgn__next" href="?page={{ posts.next_page_number }}">Наступна</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    {% endif %}
{% endblock %}
